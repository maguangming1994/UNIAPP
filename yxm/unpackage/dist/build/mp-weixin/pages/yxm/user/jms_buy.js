(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/yxm/user/jms_buy"],{"0055":function(t,n,e){"use strict";var o,i=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"b",function(){return i}),e.d(n,"c",function(){return a}),e.d(n,"a",function(){return o})},1681:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;getApp();var e={data:function(){return{count:60,mobile_number:"",token:"",btn_txt:"获取验证码",show_weixin:!0,code:""}},onLoad:function(){t.setStorageSync("wexin_connect",!1)},onShow:function(){var n=t.getStorageSync("wexin_connect");n.openid},methods:{wx_login:function(){var n=this;t.login({provider:"weixin",success:function(t){console.log(JSON.stringify(t)),wx.setStorageSync("wexin_connect",t.authResult);var e=t.authResult,o=n.bra_service("bra_app","connect_weixin_user"),i=n.fetch(o,e);i.then(function(t){console.log(t),n.log_user_in(t.user,function(t){return n.onNav({url:"/pages/hotel/index/index",type:"switch"})})},function(t){console.log(t),n.show_toast("您还没有绑定注册账号 请先注册账号!")})}})},recount:function(){var t=this;t.count>0?(setTimeout(function(){t.count--,t.recount()},1e3),this.btn_txt=t.count):(t.count=60,this.btn_txt="获取验证码")},send_sms:function(n){var e=this,o=this.bra_service("bra","send_login_verify_code"),i=this,a={mobile:i.mobile_number,is_mixed:2},u=this.fetch(o,a,"post");u.then(function(n){t.showToast({icon:"none",title:"已经发送",duration:2e3}),e.recount()},function(n){setTimeout(function(){t.showToast({icon:"none",title:n.msg,duration:2e3})},100)})},send_verify_code:function(){this.send_sms(this.mobile_number)},verify_code:function(){var n=this;if(this.code.length<4)return t.showToast({icon:"none",title:"请输入正确的验证码",duration:2e3});var e=this.bra_service("bra","verify_login_code"),o=this,i=this.fetch(e,{mobile:o.mobile_number,code:this.code});i.then(function(e){var o=e.data;o.user?n.log_user_in(o.user,function(){console.log(o),n.$store.commit("change_login",!0),n.onNav({url:"/pages/hotel/index/index",type:"switch"})}):t.showToast({icon:"none",title:o.msg||"系统错误",duration:2e3}),console.log(o)},function(n){t.showToast({icon:"none",title:n.msg||"系统错误",duration:2e3})})}}};n.default=e}).call(this,e("543d")["default"])},2180:function(t,n,e){"use strict";var o,i=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"b",function(){return i}),e.d(n,"c",function(){return a}),e.d(n,"a",function(){return o})},"489c":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;o(e("f63d"));function o(t){return t&&t.__esModule?t:{default:t}}var i=function(){return e.e("bra/forms/bra_steper").then(e.bind(null,"2f29"))},a={components:{bra_steper:i},data:function(){return{page_name:"yxm_jms_buy",module:"yxm",is_page_loaded:!1,page_data:{},fucking_params:{amount:1},params:{}}},onShow:function(){var t=this;this.checkLogin(function(n){n&&(t.is_page_loaded||t.onMhcmsPull())},!this.is_page_loaded,!0)},onPullDownRefresh:function(){this.onMhcmsPull(),t.stopPullDownRefresh()},methods:{on_bra_form_val:function(t){this.on_form_val(t)},onMhcmsPull:function(){var n=this;this.bra_common_page(this.module,this.page_name,{},!0,function(e){n.page_data=n.elements.page_data,n.is_page_loaded=!0,t.stopPullDownRefresh()})},do_buy:function(){var n=this,e=this.fucking_params;return this.bra_common_page(this.module,this.page_name,e,!0,function(e){var o=e.data.page_data;if(console.log(o),n.is_page_loaded=!0,t.stopPullDownRefresh(),6==o.code)return n.get_app_pay_params(o.data.data.id,"micropay",function(e){console.log(JSON.stringify(e)),t.requestPayment({provider:"wxpay",orderInfo:JSON.stringify(e),success:function(t){n.show_toast("支付成功"),n.do_buy()},fail:function(t){console.log("fail:"+JSON.stringify(t)),n.show_toast("支付失败")}})});1==o.code?(n.show_toast(o.msg),n.onNav({url:"/pages/yxm/user/index",type:"redirect"})):n.show_toast(o.msg)},"post",!1)}},computed:{total_price:function(){if(!this.fucking_params.amount)return console.log(this.page_data.price,this.fucking_params.amount),"";var t=parseFloat(this.page_data.price)*parseInt(this.fucking_params.amount);return t.toFixed(2)}}};n.default=a}).call(this,e("543d")["default"])},"6c41":function(t,n,e){"use strict";(function(t){e("5e7b"),e("921b");o(e("66fd"));var n=o(e("ff1a"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},"73c3":function(t,n,e){"use strict";var o=e("cd71"),i=e.n(o);i.a},"84db":function(t,n,e){"use strict";e.r(n);var o=e("489c"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,function(){return o[t]})}(a);n["default"]=i.a},9095:function(t,n,e){"use strict";e.r(n);var o=e("1681"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,function(){return o[t]})}(a);n["default"]=i.a},cd71:function(t,n,e){},f63d:function(t,n,e){"use strict";e.r(n);var o=e("0055"),i=e("9095");for(var a in i)"default"!==a&&function(t){e.d(n,t,function(){return i[t]})}(a);e("73c3");var u,s=e("f0c5"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);n["default"]=r.exports},ff1a:function(t,n,e){"use strict";e.r(n);var o=e("2180"),i=e("84db");for(var a in i)"default"!==a&&function(t){e.d(n,t,function(){return i[t]})}(a);var u,s=e("f0c5"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);n["default"]=r.exports}},[["6c41","common/runtime","common/vendor"]]]);