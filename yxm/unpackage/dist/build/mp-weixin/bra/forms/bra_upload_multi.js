(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["bra/forms/bra_upload_multi"],{"27c9":function(t,e,a){"use strict";var o,n=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"b",function(){return n}),a.d(e,"c",function(){return i}),a.d(e,"a",function(){return o})},5170:function(t,e,a){"use strict";a.r(e);var o=a("5989"),n=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);e["default"]=n.a},"547a":function(t,e,a){"use strict";a.r(e);var o=a("27c9"),n=a("5170");for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);a("74cb");var u,l=a("f0c5"),s=Object(l["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);e["default"]=s.exports},5989:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("5680")),n=a("2d5f");function i(t){return t&&t.__esModule?t:{default:t}}var u={props:{field_name:{type:"",default:function(){return[]}},default_value:{default:""},options:{type:"",default:function(){return[]}},level:{default:0},name_key:{default:"name"},single_column:{type:"",default:function(){return[]}},group:{type:String,default:""},unit:{type:String,default:""},mini_type_prop:{type:String,default:""},prop_placeholder:{type:String,default:""},max_amount:{type:Number,default:1},show_extra:{default:!1}},data:function(){return{upload:[],file_ids:[],form_type:!1,placeholder:"",params:{}}},methods:{out_put:function(t){console.log("mhcms out:",t),this.$emit("updated",t)},onOpenPictureTap:function(e){var a=this,o=this,i=e.currentTarget.dataset,u=i.group,l=i.max_amount;t.chooseImage({count:parseInt(l),success:function(t){if(a.upload.length>=l)return a.show_toast("对不起,最多上传"+l+"张图片或文件!");n._.each(t.tempFilePaths,function(t){a.upload.push({filePath:t,status:0})}),o.$set(a,"upload",a.upload),a.uploadImage(function(){console.log(u+"all files is uploaded");var t=[u,a.file_ids];a.out_put(t)})}})},upload_file:function(e,a,o,i,u,l){t.showToast({title:"上传中...",icon:"loading",duration:1e4});var s=n._.extend({},{url:e,filePath:a,name:o,formData:this.params,header:{Accept:"application/json, text/javascript, */*; q=0.01"},success:function(e){console.log(e),e=JSON.parse(e.data),s.isLoginInvalid=!1,1==e.code?u.apply(l,[e.data,e]):t.showModal({content:e.msg,showCancel:!1})},fail:function(e){console.error(e),t.showModal({content:e.msg,showCancel:!1})},complete:function(e){s.isLoginInvalid||t.hideToast()}});return s.requestId=n._.uniqueId("RQ"),console.log(s),t.uploadFile(s),s.requestId},onDeleteImgTap:function(e){var a=this;this.isDeleteAction=!0;var o=e.currentTarget.dataset,n=o.index,i=o.group;t.showActionSheet({itemList:["删除"],success:function(t){if(0===t.tapIndex){a.upload.splice(n,1),a.file_ids.splice(n,1);var e=[i,a.file_ids];a.out_put(e)}},complete:function(){a.isDeleteAction=!1}})},onPreviewTap:function(e){if(!this.isDeleteAction){var a=e.currentTarget.dataset,o=a.index,n="";n=this.upload[o].filePath?this.upload[o].filePath:this.upload[o].url,console.log(o),console.log(this.upload),console.log(this.upload[o]),t.previewImage({current:n,urls:[n]})}},upload_handle:function(t,e){var a=this,o=this.upload[t],n=this.upload[t].status;if(console.log(t,this.upload[t]),99==n)return t++,this.upload_handle(t,function(){"function"==typeof e&&e()});this.isUploading=!0,this.upload_file(this.bra_service("bra","upload",!0),o.filePath,"file",{},function(o){console.log(o),a.upload[t].status=99,a.upload[t].url=o,a.upload[t].id=o.id,a.file_ids.push(o.id),a.isUploading=!1,t++,t<a.upload.length?a.upload_handle(t):"function"==typeof e&&e()})},uploadImage:function(t){var e=this.isUploading;if(e)return console.log("file is still uploading  "),!1;console.log("file is still uploading "),this.isUploading=!0,this.upload_handle(0,function(){"function"==typeof t&&t()})}},created:function(){if(this.placeholder=this.prop_placeholder,this.default_value.length>0)for(var e in this.default_value)this.default_value[e].status=99,this.upload.push(this.default_value[e]),this.file_ids.push(this.default_value[e].id);var a=o.default;a.bra_action="post",a.bra_uuid=t.getStorageSync("bra_uuid");var n=t.getStorageSync("user")||!1;n&&(a.__bra_token=n.auth_str),this.params=a,console.log(this.params)}};e.default=u}).call(this,a("543d")["default"])},"74cb":function(t,e,a){"use strict";var o=a("d557"),n=a.n(o);n.a},d557:function(t,e,a){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'bra/forms/bra_upload_multi-create-component',
    {
        'bra/forms/bra_upload_multi-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("547a"))
        })
    },
    [['bra/forms/bra_upload_multi-create-component']]
]);
